{{/*
  Bike Timeline Shortcode

  Usage: {{< biketimeline src="cycling" >}}

  Parameters:
    - src (required): Path to directory containing bike photos (relative to /static)

  File naming convention: ##BikeNameMonYY.jpg (e.g., 00BigBlueJul21.jpg)
    - First 2 digits: Sorting order (00, 01, 02, etc.)
    - BikeName: Descriptive name for the bike
    - MonYY: Month abbreviation + 2-digit year (e.g., Jul21, Apr25, Oct25)

  Supported dates: Jul21, Nov21, Apr23, Apr25, Jul25, Oct25
  To add new dates, update the date parsing logic in this file (lines ~40-60).

  Displays an elegant timeline visualization with dates on alternating sides.
  All styling is in /static/css/custom-responsive.css under "Bike Timeline Styles".
*/}}
{{ partial "gallery-deps.html" . }}

<div class="bike-timeline">
    {{ $galleryName := .Get "src" }}
    {{ $path := print "static" "/" $galleryName }}
    {{ $files := readDir $path }}

    {{ range $files }}
        {{ $ext := path.Ext .Name | lower }}
        {{ if or (eq $ext ".jpg") (eq $ext ".jpeg") (eq $ext ".png") (eq $ext ".gif") (eq $ext ".webp") }}
            {{ $src := print $galleryName "/" .Name }}

            {{/* Extract date from filename - format: 00BigBlueJul21.jpg */}}
            {{ $filename := .Name }}
            {{ $month := "" }}
            {{ $year := "" }}

            {{/* Parse date from filename */}}
            {{ if findRE "Jul21" $filename }}
                {{ $month = "July" }}
                {{ $year = "2021" }}
            {{ else if findRE "Nov21" $filename }}
                {{ $month = "November" }}
                {{ $year = "2021" }}
            {{ else if findRE "Apr23" $filename }}
                {{ $month = "April" }}
                {{ $year = "2023" }}
            {{ else if findRE "Apr25" $filename }}
                {{ $month = "April" }}
                {{ $year = "2025" }}
            {{ else if findRE "Jul25" $filename }}
                {{ $month = "July" }}
                {{ $year = "2025" }}
            {{ else if findRE "Oct25" $filename }}
                {{ $month = "October" }}
                {{ $year = "2025" }}
            {{ end }}

            <div class="timeline-item">
                <div class="timeline-date">
                    <span class="date-month">{{ $month }}</span>
                    <span class="date-year">{{ $year }}</span>
                </div>
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                    <a href="{{ $src | absURL }}" data-fancybox="bike-timeline" data-caption="{{ $month }} {{ $year }}">
                        <img src="{{ $src | absURL }}" alt="Bike - {{ $month }} {{ $year }}" loading="lazy">
                    </a>
                </div>
            </div>
        {{ end }}
    {{ end }}
</div>
